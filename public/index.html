<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Quickly turn Google Sheets into a JSON endpoint."
    />
    <title>sheet.spacet.me</title>
    <meta
      property="og:image"
      content="https://capture.the.spacet.me/https://capture.the.spacet.me/eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1cmwiOiJodHRwczovL3NoZWV0LnNwYWNldC5tZS8iLCJ3aWR0aCI6NjAwLCJoZWlnaHQiOjMxNSwiZGV2aWNlU2NhbGVGYWN0b3IiOjIsImlzcyI6ImR0aW50aCJ9.ioo3Qd7CnHjZadYSJO2oFmS9BI5rQQ3YGk_zCIV03KrfYOFEzkb3rpwz5Z0O-TCvLPlfpTC1iK9JVWTcsRKNmuqdsd3HEFiNHL6wNL8lSHODkbWt5Xs6p0UGa_0kv2bplDAAGgzpKGvJwF2z1S35ZrPzD_0o6jnvg5xEydlA3yH7hwR4v5QVADDI0WIiM05lPmZg0SD_H36tPrhx5uHPgAx8ilmN3uRRWLlg70e-skeJunIaqZgKTLfWhxyjsYc5RWwcgGEVn7_J72TRYTUHtHjbSn1_m0mb60EI9Xg_UZBlsf09R3ojMYTDskJ7_DlPCiWr2g_5LwFws01jgGz1pg.png"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-ECSE6V6VK2"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag('js', new Date())

      gtag('config', 'G-ECSE6V6VK2')
    </script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/water.css@2/out/light.css"
    />
    <style>
      code > strong {
        color: #379;
      }
    </style>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-ECSE6V6VK2"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag('js', new Date())

      gtag('config', 'G-ECSE6V6VK2')
    </script>
  </head>
  <body>
    <h1>sheet.spacet.me</h1>
    <p>Quickly turn Google Sheets into a JSON endpoint.</p>

    <h2>Usage</h2>
    <ol>
      <li>
        Make the sheet accessible to this service by doing any of these:
        <ul>
          <li>
            Share the sheet with <code id="email">(service account email)</code>
          </li>
          <li>Make the sheet viewable by anyone with the link.</li>
        </ul>
      </li>
      <li>Use the API (see below).</li>
    </ol>

    <script>
      fetch('/api/sheet')
        .then((r) => r.json())
        .then((x) => (document.querySelector('#email').textContent = x.email))
    </script>

    <h2>API</h2>
    <ul>
      <li>
        <code
          >GET /<strong>sheetId</strong>/<strong>sheetName</strong>.json</code
        >
        &mdash; Returns the sheet data as JSON (<a
          href="/1_hCWsZ13xSnjnmSCx4flTFJCZ6D4yRZjDsaYDchqu08/Sheet1.json"
          >example</a
        >)
      </li>
    </ul>

    <h2>Usage notes</h2>
    <ul>
      <li>
        I made this API mainly for convenience. There is no uptime guarantee.
      </li>
      <li>
        It is backed by two layers of CDN caching: Cloudflare and Vercel Edge
        Network.
      </li>
      <li>Responses are cached for about 1 minute.</li>
    </ul>

    <hr />
    <p>API built by <a href="https://dt.in.th">@dtinth</a>.</p>
    <script>
      if (location.hash === '#og') {
        document.body.style.marginTop = '150px'
      }
    </script>
    <script>
      fetch('/api/random-tweet')
        .then((r) => r.json())
        .catch((e) => {
          return {
            text: `${e}`,
          }
        })
        .then((j) => {
          textEl.textContent = j.text
          if (j.user) {
            attributionEl.innerHTML = `&mdash;<a href="${j.url}">@${j.user.screen_name}</a>`
          }
        })
    </script>
  </body>
</html>
